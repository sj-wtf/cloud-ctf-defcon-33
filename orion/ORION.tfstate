{
  "version": 4,
  "terraform_version": "1.5.7",
  "serial": 3,
  "lineage": "1a1c6ca1-6594-71f7-8453-760616532226",
  "outputs": {
    "bucket_name": {
      "value": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
      "type": "string"
    }
  },
  "resources": [
    {
      "module": "module.cloudwatch",
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "lambda_logs",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:logs:us-west-1:691903504411:log-group:/aws/lambda/dc-33-cv-tf-processor",
            "id": "/aws/lambda/dc-33-cv-tf-processor",
            "kms_key_id": "",
            "log_group_class": "STANDARD",
            "name": "/aws/lambda/dc-33-cv-tf-processor",
            "name_prefix": "",
            "retention_in_days": 3,
            "skip_destroy": false,
            "tags": {},
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.data.aws_iam_policy_document.lambda_assume_role",
            "module.lambda.aws_lambda_function.dc-33-cv_lambda"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_caller_identity",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "account_id": "691903504411",
            "arn": "arn:aws:sts::691903504411:assumed-role/AWSReservedSSO_AdministratorAccess_267910e055e0253e/eduard",
            "id": "691903504411",
            "user_id": "AROA2CGFJUANVE7IA6OFG:eduard"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "dc_33_cv_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "271681141",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"ec2:DescribeInstances\",\n        \"ec2:DescribeImages\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"ec2:DescribeInstances\",\"ec2:DescribeImages\"],\"Resource\":\"*\"}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "ec2:DescribeImages",
                  "ec2:DescribeInstances"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "*"
                ],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "lambda_assume_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "2690255455",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      }\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRole\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "sts:AssumeRole"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "lambda.amazonaws.com"
                    ],
                    "type": "Service"
                  }
                ],
                "resources": [],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "s3_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "1238729154",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:ListBucket\",\n      \"Resource\": \"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"s3:GetObject\",\n      \"Resource\": \"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y/flag.txt\"\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"s3:ListBucket\",\"Resource\":\"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y\"},{\"Effect\":\"Allow\",\"Action\":\"s3:GetObject\",\"Resource\":\"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y/flag.txt\"}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "s3:ListBucket"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y"
                ],
                "sid": ""
              },
              {
                "actions": [
                  "s3:GetObject"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y/flag.txt"
                ],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "terraform_oidc_assume_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "1993733891",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRoleWithWebIdentity\",\n      \"Principal\": {\n        \"Federated\": \"arn:aws:iam::691903504411:oidc-provider/app.terraform.io\"\n      },\n      \"Condition\": {\n        \"StringEquals\": {\n          \"app.terraform.io:aud\": \"aws.workload.identity\"\n        },\n        \"StringLike\": {\n          \"app.terraform.io:sub\": \"organization:cloud-village-*:workspace:dc-33-cv-tf:*\"\n        }\n      }\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Principal\":{\"Federated\":\"arn:aws:iam::691903504411:oidc-provider/app.terraform.io\"},\"Condition\":{\"StringEquals\":{\"app.terraform.io:aud\":\"aws.workload.identity\"},\"StringLike\":{\"app.terraform.io:sub\":\"organization:cloud-village-*:workspace:dc-33-cv-tf:*\"}}}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "sts:AssumeRoleWithWebIdentity"
                ],
                "condition": [
                  {
                    "test": "StringEquals",
                    "values": [
                      "aws.workload.identity"
                    ],
                    "variable": "app.terraform.io:aud"
                  },
                  {
                    "test": "StringLike",
                    "values": [
                      "organization:cloud-village-*:workspace:dc-33-cv-tf:*"
                    ],
                    "variable": "app.terraform.io:sub"
                  }
                ],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [
                  {
                    "identifiers": [
                      "arn:aws:iam::691903504411:oidc-provider/app.terraform.io"
                    ],
                    "type": "Federated"
                  }
                ],
                "resources": [],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "data",
      "type": "aws_iam_policy_document",
      "name": "terraform_user_management",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "3078628882",
            "json": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListUserPolicies\",\n        \"iam:ListAttachedUserPolicies\",\n        \"iam:GetUser\",\n        \"iam:CreateUser\"\n      ],\n      \"Resource\": \"arn:aws:iam::691903504411:user/terraform-dc33-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"iam:ListAccessKeys\",\n        \"iam:CreateAccessKey\"\n      ],\n      \"Resource\": \"arn:aws:iam::691903504411:user/terraform-dc33-*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:AttachUserPolicy\",\n      \"Resource\": \"arn:aws:iam::691903504411:user/terraform-dc33-*\",\n      \"Condition\": {\n        \"ArnEquals\": {\n          \"iam:PolicyArn\": \"arn:aws:iam::691903504411:policy/S3BucketAccessPolicy\"\n        }\n      }\n    }\n  ]\n}",
            "minified_json": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Action\":[\"iam:ListUserPolicies\",\"iam:ListAttachedUserPolicies\",\"iam:GetUser\",\"iam:CreateUser\"],\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\"},{\"Effect\":\"Allow\",\"Action\":[\"iam:ListAccessKeys\",\"iam:CreateAccessKey\"],\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\"},{\"Effect\":\"Allow\",\"Action\":\"iam:AttachUserPolicy\",\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\",\"Condition\":{\"ArnEquals\":{\"iam:PolicyArn\":\"arn:aws:iam::691903504411:policy/S3BucketAccessPolicy\"}}}]}",
            "override_json": null,
            "override_policy_documents": null,
            "policy_id": null,
            "source_json": null,
            "source_policy_documents": null,
            "statement": [
              {
                "actions": [
                  "iam:CreateUser",
                  "iam:GetUser",
                  "iam:ListAttachedUserPolicies",
                  "iam:ListUserPolicies"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "arn:aws:iam::691903504411:user/terraform-dc33-*"
                ],
                "sid": ""
              },
              {
                "actions": [
                  "iam:CreateAccessKey",
                  "iam:ListAccessKeys"
                ],
                "condition": [],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "arn:aws:iam::691903504411:user/terraform-dc33-*"
                ],
                "sid": ""
              },
              {
                "actions": [
                  "iam:AttachUserPolicy"
                ],
                "condition": [
                  {
                    "test": "ArnEquals",
                    "values": [
                      "arn:aws:iam::691903504411:policy/S3BucketAccessPolicy"
                    ],
                    "variable": "iam:PolicyArn"
                  }
                ],
                "effect": "Allow",
                "not_actions": [],
                "not_principals": [],
                "not_resources": [],
                "principals": [],
                "resources": [
                  "arn:aws:iam::691903504411:user/terraform-dc33-*"
                ],
                "sid": ""
              }
            ],
            "version": "2012-10-17"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_openid_connect_provider",
      "name": "terraform_cloud",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:oidc-provider/app.terraform.io",
            "client_id_list": [
              "aws.workload.identity"
            ],
            "id": "arn:aws:iam::691903504411:oidc-provider/app.terraform.io",
            "tags": {
              "Name": "terraform-cloud-oidc"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "terraform-cloud-oidc",
              "Project": "defcon-33-cv-tf"
            },
            "thumbprint_list": [
              "9e99a48a9960b14926bb7f3b02e22da2b0ab7280"
            ],
            "url": "app.terraform.io"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "dc-33-cv_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:policy/DefconServicePolicy",
            "attachment_count": 1,
            "description": "",
            "id": "arn:aws:iam::691903504411:policy/DefconServicePolicy",
            "name": "DefconServicePolicy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"ec2:DescribeInstances\",\"ec2:DescribeImages\"],\"Effect\":\"Allow\",\"Resource\":\"*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA2CGFJUAN2UYYM3MYX",
            "tags": {},
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.data.aws_iam_policy_document.dc_33_cv_policy"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "s3_access",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:policy/S3BucketAccessPolicy",
            "attachment_count": 0,
            "description": "Policy for accessing bucket",
            "id": "arn:aws:iam::691903504411:policy/S3BucketAccessPolicy",
            "name": "S3BucketAccessPolicy",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":\"s3:ListBucket\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y\"},{\"Action\":\"s3:GetObject\",\"Effect\":\"Allow\",\"Resource\":\"arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y/flag.txt\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA2CGFJUAN7PYHNYPDP",
            "tags": {},
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.data.aws_iam_policy_document.s3_access",
            "module.s3.aws_s3_bucket.s3_storage_bucket",
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_policy",
      "name": "terraform_user_management",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:policy/TerraformDC33UserManagement",
            "attachment_count": 1,
            "description": "Policy for managing terraform-dc33- users",
            "id": "arn:aws:iam::691903504411:policy/TerraformDC33UserManagement",
            "name": "TerraformDC33UserManagement",
            "name_prefix": "",
            "path": "/",
            "policy": "{\"Statement\":[{\"Action\":[\"iam:ListUserPolicies\",\"iam:ListAttachedUserPolicies\",\"iam:GetUser\",\"iam:CreateUser\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\"},{\"Action\":[\"iam:ListAccessKeys\",\"iam:CreateAccessKey\"],\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\"},{\"Action\":\"iam:AttachUserPolicy\",\"Condition\":{\"ArnEquals\":{\"iam:PolicyArn\":\"arn:aws:iam::691903504411:policy/S3BucketAccessPolicy\"}},\"Effect\":\"Allow\",\"Resource\":\"arn:aws:iam::691903504411:user/terraform-dc33-*\"}],\"Version\":\"2012-10-17\"}",
            "policy_id": "ANPA2CGFJUAN4B37VMWPE",
            "tags": {},
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf"
            }
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_policy.s3_access",
            "module.iam.data.aws_caller_identity.current",
            "module.iam.data.aws_iam_policy_document.s3_access",
            "module.iam.data.aws_iam_policy_document.terraform_user_management",
            "module.s3.aws_s3_bucket.s3_storage_bucket",
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "lambda_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:role/dc-33-cv-tf-lambda-role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRole\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-08-06T00:09:44Z",
            "description": "",
            "force_detach_policies": false,
            "id": "dc-33-cv-tf-lambda-role",
            "inline_policy": [],
            "managed_policy_arns": [],
            "max_session_duration": 3600,
            "name": "dc-33-cv-tf-lambda-role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {},
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf"
            },
            "unique_id": "AROA2CGFJUAN4EHUUMQPB"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.data.aws_iam_policy_document.lambda_assume_role"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role",
      "name": "terraform_oidc_role",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:role/TerraformCloudDC33Role",
            "assume_role_policy": "{\"Statement\":[{\"Action\":\"sts:AssumeRoleWithWebIdentity\",\"Condition\":{\"StringEquals\":{\"app.terraform.io:aud\":\"aws.workload.identity\"},\"StringLike\":{\"app.terraform.io:sub\":\"organization:cloud-village-*:workspace:dc-33-cv-tf:*\"}},\"Effect\":\"Allow\",\"Principal\":{\"Federated\":\"arn:aws:iam::691903504411:oidc-provider/app.terraform.io\"}}],\"Version\":\"2012-10-17\"}",
            "create_date": "2025-08-06T00:09:45Z",
            "description": "",
            "force_detach_policies": false,
            "id": "TerraformCloudDC33Role",
            "inline_policy": [],
            "managed_policy_arns": [
              "arn:aws:iam::691903504411:policy/TerraformDC33UserManagement"
            ],
            "max_session_duration": 3600,
            "name": "TerraformCloudDC33Role",
            "name_prefix": "",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Name": "terraform-cloud-dc33-role"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "terraform-cloud-dc33-role",
              "Project": "defcon-33-cv-tf"
            },
            "unique_id": "AROA2CGFJUANQAAL5PE4L"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_openid_connect_provider.terraform_cloud",
            "module.iam.data.aws_iam_policy_document.terraform_oidc_assume_role"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_role_policy_attachment",
      "name": "terraform_role_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "TerraformCloudDC33Role-20250806000952239000000002",
            "policy_arn": "arn:aws:iam::691903504411:policy/TerraformDC33UserManagement",
            "role": "TerraformCloudDC33Role"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_openid_connect_provider.terraform_cloud",
            "module.iam.aws_iam_policy.s3_access",
            "module.iam.aws_iam_policy.terraform_user_management",
            "module.iam.aws_iam_role.terraform_oidc_role",
            "module.iam.data.aws_caller_identity.current",
            "module.iam.data.aws_iam_policy_document.s3_access",
            "module.iam.data.aws_iam_policy_document.terraform_oidc_assume_role",
            "module.iam.data.aws_iam_policy_document.terraform_user_management",
            "module.s3.aws_s3_bucket.s3_storage_bucket",
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_user",
      "name": "dc-33-cv_user",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:iam::691903504411:user/dc-33-cv-tf-service-user",
            "force_destroy": false,
            "id": "dc-33-cv-tf-service-user",
            "name": "dc-33-cv-tf-service-user",
            "path": "/",
            "permissions_boundary": "",
            "tags": {
              "Purpose": "Service Account"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf",
              "Purpose": "Service Account"
            },
            "unique_id": "AIDA2CGFJUAN7DS436TY5"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "module": "module.iam",
      "mode": "managed",
      "type": "aws_iam_user_policy_attachment",
      "name": "dc-33-cv_attachment",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "id": "dc-33-cv-tf-service-user-20250806000945988300000001",
            "policy_arn": "arn:aws:iam::691903504411:policy/DefconServicePolicy",
            "user": "dc-33-cv-tf-service-user"
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.iam.aws_iam_policy.dc-33-cv_policy",
            "module.iam.aws_iam_user.dc-33-cv_user",
            "module.iam.data.aws_iam_policy_document.dc_33_cv_policy"
          ]
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "data",
      "type": "archive_file",
      "name": "lambda_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "639bfe48c5bdee0cbe778111222bd8df5ac4cd27",
            "output_base64sha256": "aD+7Lo2NuJSh7esx2TLUobnl2Fo5uucFODJnfcPioRk=",
            "output_base64sha512": "qhOulMSXZ8Tn/n0ZmS7D3VogzcF1qlWMbJFAjNAW0iAzPsQRoYMZkULjMAxWMO/2kVO8BAFgiJ9/gvBsgd63Eg==",
            "output_file_mode": null,
            "output_md5": "54add27ce0b0ebbb340ed358d2c72aee",
            "output_path": "dc-33-cv_function.zip",
            "output_sha": "639bfe48c5bdee0cbe778111222bd8df5ac4cd27",
            "output_sha256": "683fbb2e8d8db894a1edeb31d932d4a1b9e5d85a39bae7053832677dc3e2a119",
            "output_sha512": "aa13ae94c49767c4e7fe7d19992ec3dd5a20cdc175aa558c6c91408cd016d220333ec411a183199142e3300c5630eff69153bc040160889f7f82f06c81deb712",
            "output_size": 191,
            "source": [
              {
                "content": "def handler(event, context): return {'statusCode': 200}",
                "filename": "index.py"
              }
            ],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": null,
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.lambda",
      "mode": "managed",
      "type": "aws_lambda_function",
      "name": "dc-33-cv_lambda",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "architectures": [
              "x86_64"
            ],
            "arn": "arn:aws:lambda:us-west-1:691903504411:function:dc-33-cv-tf-processor",
            "code_sha256": "aD+7Lo2NuJSh7esx2TLUobnl2Fo5uucFODJnfcPioRk=",
            "code_signing_config_arn": "",
            "dead_letter_config": [],
            "description": "",
            "environment": [],
            "ephemeral_storage": [
              {
                "size": 512
              }
            ],
            "file_system_config": [],
            "filename": "dc-33-cv_function.zip",
            "function_name": "dc-33-cv-tf-processor",
            "handler": "index.handler",
            "id": "dc-33-cv-tf-processor",
            "image_config": [],
            "image_uri": "",
            "invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:691903504411:function:dc-33-cv-tf-processor/invocations",
            "kms_key_arn": "",
            "last_modified": "2025-08-06T00:09:51.395+0000",
            "layers": [],
            "logging_config": [
              {
                "application_log_level": "",
                "log_format": "Text",
                "log_group": "/aws/lambda/dc-33-cv-tf-processor",
                "system_log_level": ""
              }
            ],
            "memory_size": 128,
            "package_type": "Zip",
            "publish": false,
            "qualified_arn": "arn:aws:lambda:us-west-1:691903504411:function:dc-33-cv-tf-processor:$LATEST",
            "qualified_invoke_arn": "arn:aws:apigateway:us-west-1:lambda:path/2015-03-31/functions/arn:aws:lambda:us-west-1:691903504411:function:dc-33-cv-tf-processor:$LATEST/invocations",
            "replace_security_groups_on_destroy": null,
            "replacement_security_group_ids": null,
            "reserved_concurrent_executions": -1,
            "role": "arn:aws:iam::691903504411:role/dc-33-cv-tf-lambda-role",
            "runtime": "python3.9",
            "s3_bucket": null,
            "s3_key": null,
            "s3_object_version": null,
            "signing_job_arn": "",
            "signing_profile_version_arn": "",
            "skip_destroy": false,
            "snap_start": [],
            "source_code_hash": "",
            "source_code_size": 191,
            "tags": {
              "Purpose": "Data Processing"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Project": "defcon-33-cv-tf",
              "Purpose": "Data Processing"
            },
            "timeout": 3,
            "timeouts": null,
            "tracing_config": [
              {
                "mode": "PassThrough"
              }
            ],
            "version": "$LATEST",
            "vpc_config": []
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.iam.aws_iam_role.lambda_role",
            "module.iam.data.aws_iam_policy_document.lambda_assume_role"
          ]
        }
      ]
    },
    {
      "module": "module.s3",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "s3_storage_bucket",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acceleration_status": "",
            "acl": null,
            "arn": "arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "bucket": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "bucket_domain_name": "dc-33-cv-tf-ctf-bucket-cxc0p38y.s3.amazonaws.com",
            "bucket_prefix": "",
            "bucket_regional_domain_name": "dc-33-cv-tf-ctf-bucket-cxc0p38y.s3.us-west-1.amazonaws.com",
            "cors_rule": [],
            "force_destroy": true,
            "grant": [
              {
                "id": "fbcc0070a44d5f62eaf1bba736f9aeca9b4b1b902db8b4c41b41141f15a436a9",
                "permissions": [
                  "FULL_CONTROL"
                ],
                "type": "CanonicalUser",
                "uri": ""
              }
            ],
            "hosted_zone_id": "Z2F56UZL2M1ACD",
            "id": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "lifecycle_rule": [],
            "logging": [],
            "object_lock_configuration": [],
            "object_lock_enabled": false,
            "policy": "",
            "region": "us-west-1",
            "replication_configuration": [],
            "request_payer": "BucketOwner",
            "server_side_encryption_configuration": [
              {
                "rule": [
                  {
                    "apply_server_side_encryption_by_default": [
                      {
                        "kms_master_key_id": "",
                        "sse_algorithm": "AES256"
                      }
                    ],
                    "bucket_key_enabled": false
                  }
                ]
              }
            ],
            "tags": {
              "Name": "dc-33-cv-tf-bucket"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "dc-33-cv-tf-bucket",
              "Project": "defcon-33-cv-tf"
            },
            "timeouts": null,
            "versioning": [
              {
                "enabled": false,
                "mfa_delete": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjM2MDAwMDAwMDAwMDAsInJlYWQiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.s3",
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "bucket_pab",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "block_public_acls": true,
            "block_public_policy": true,
            "bucket": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "id": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "ignore_public_acls": true,
            "restrict_public_buckets": true
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.s3_storage_bucket",
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.s3",
      "mode": "managed",
      "type": "aws_s3_object",
      "name": "flag",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "acl": null,
            "arn": "arn:aws:s3:::dc-33-cv-tf-ctf-bucket-cxc0p38y/flag.txt",
            "bucket": "dc-33-cv-tf-ctf-bucket-cxc0p38y",
            "bucket_key_enabled": false,
            "cache_control": "",
            "checksum_algorithm": null,
            "checksum_crc32": "",
            "checksum_crc32c": "",
            "checksum_crc64nvme": "",
            "checksum_sha1": "",
            "checksum_sha256": "",
            "content": null,
            "content_base64": null,
            "content_disposition": "",
            "content_encoding": "",
            "content_language": "",
            "content_type": "application/octet-stream",
            "etag": "e23b6279aaa688a071cf0bb09135023a",
            "force_destroy": false,
            "id": "flag.txt",
            "key": "flag.txt",
            "kms_key_id": null,
            "metadata": {},
            "object_lock_legal_hold_status": "",
            "object_lock_mode": "",
            "object_lock_retain_until_date": "",
            "override_provider": [],
            "server_side_encryption": "AES256",
            "source": "shared/flag.txt",
            "source_hash": null,
            "storage_class": "STANDARD",
            "tags": {
              "Name": "ctf-flag"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "ctf-flag",
              "Project": "defcon-33-cv-tf"
            },
            "version_id": "",
            "website_redirect": ""
          },
          "sensitive_attributes": [],
          "private": "bnVsbA==",
          "dependencies": [
            "module.s3.aws_s3_bucket.s3_storage_bucket",
            "module.s3.random_string.bucket_suffix"
          ]
        }
      ]
    },
    {
      "module": "module.s3",
      "mode": "managed",
      "type": "random_string",
      "name": "bucket_suffix",
      "provider": "provider[\"registry.terraform.io/hashicorp/random\"]",
      "instances": [
        {
          "schema_version": 2,
          "attributes": {
            "id": "cxc0p38y",
            "keepers": null,
            "length": 8,
            "lower": true,
            "min_lower": 0,
            "min_numeric": 0,
            "min_special": 0,
            "min_upper": 0,
            "number": true,
            "numeric": true,
            "override_special": null,
            "result": "cxc0p38y",
            "special": false,
            "upper": false
          },
          "sensitive_attributes": []
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_internet_gateway",
      "name": "dc-33-cv_igw",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "arn": "arn:aws:ec2:us-west-1:691903504411:internet-gateway/igw-089ab8b28fe26b8e2",
            "id": "igw-089ab8b28fe26b8e2",
            "owner_id": "691903504411",
            "tags": {
              "Name": "dc-33-cv-tf-igw"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "dc-33-cv-tf-igw",
              "Project": "defcon-33-cv-tf"
            },
            "timeouts": null,
            "vpc_id": "vpc-0ca828f669a8e7157"
          },
          "sensitive_attributes": [],
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxMjAwMDAwMDAwMDAwLCJkZWxldGUiOjEyMDAwMDAwMDAwMDAsInVwZGF0ZSI6MTIwMDAwMDAwMDAwMH19",
          "dependencies": [
            "module.vpc.aws_vpc.dc-33-cv_vpc"
          ]
        }
      ]
    },
    {
      "module": "module.vpc",
      "mode": "managed",
      "type": "aws_vpc",
      "name": "dc-33-cv_vpc",
      "provider": "provider[\"registry.terraform.io/hashicorp/aws\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "arn": "arn:aws:ec2:us-west-1:691903504411:vpc/vpc-0ca828f669a8e7157",
            "assign_generated_ipv6_cidr_block": false,
            "cidr_block": "172.16.74.32/28",
            "default_network_acl_id": "acl-0dddda05466213d57",
            "default_route_table_id": "rtb-0ea1b174261a0ee33",
            "default_security_group_id": "sg-067825d38573e57c1",
            "dhcp_options_id": "dopt-0485c280c6eb2f032",
            "enable_dns_hostnames": false,
            "enable_dns_support": false,
            "enable_network_address_usage_metrics": false,
            "id": "vpc-0ca828f669a8e7157",
            "instance_tenancy": "default",
            "ipv4_ipam_pool_id": null,
            "ipv4_netmask_length": null,
            "ipv6_association_id": "",
            "ipv6_cidr_block": "",
            "ipv6_cidr_block_network_border_group": "",
            "ipv6_ipam_pool_id": "",
            "ipv6_netmask_length": 0,
            "main_route_table_id": "rtb-0ea1b174261a0ee33",
            "owner_id": "691903504411",
            "tags": {
              "Name": "dc-33-cv-tf-vpc"
            },
            "tags_all": {
              "Challenge": "orion",
              "Environment": "prod",
              "Name": "dc-33-cv-tf-vpc",
              "Project": "defcon-33-cv-tf"
            }
          },
          "sensitive_attributes": [],
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ],
  "check_results": null
}
